!function(t){"use strict";var o=0;function n(o,n){return t.map(o,function(t){return t+".touchspin_"+n})}t.fn.TouchSpin=function(s){if("destroy"!==s){var e={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalupclass:"glyphicon glyphicon-chevron-up",verticaldownclass:"glyphicon glyphicon-chevron-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default",buttondown_txt:"-",buttonup_txt:"+"},i={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){var a,p,u,r,c,l,d,f,v=t(this),h=v.data(),b=0,x=!1;function m(){var t,o,n;""!==(t=v.val())?a.decimals>0&&"."===t||(o=parseFloat(t),isNaN(o)&&(o=""!==a.replacementval?a.replacementval:0),n=o,o.toString()!==t&&(n=o),o<a.min&&(n=a.min),o>a.max&&(n=a.max),n=function(t){switch(a.forcestepdivisibility){case"round":return(Math.round(t/a.step)*a.step).toFixed(a.decimals);case"floor":return(Math.floor(t/a.step)*a.step).toFixed(a.decimals);case"ceil":return(Math.ceil(t/a.step)*a.step).toFixed(a.decimals);default:return t}}(n),Number(t).toString()!==n.toString()&&(v.val(n),v.trigger("change"))):""!==a.replacementval&&(v.val(a.replacementval),v.trigger("change"))}function g(){if(a.booster){var t=Math.pow(2,Math.floor(b/a.boostat))*a.step;return a.maxboostedstep&&t>a.maxboostedstep&&(t=a.maxboostedstep,r=Math.round(r/t)*t),Math.max(a.step,t)}return a.step}function w(){m(),r=parseFloat(u.input.val()),isNaN(r)&&(r=0);var t=r,o=g();(r+=o)>a.max&&(r=a.max,v.trigger("touchspin.on.max"),D()),u.input.val(Number(r).toFixed(a.decimals)),t!==r&&v.trigger("change")}function y(){m(),r=parseFloat(u.input.val()),isNaN(r)&&(r=0);var t=r,o=g();(r-=o)<a.min&&(r=a.min,v.trigger("touchspin.on.min"),D()),u.input.val(r.toFixed(a.decimals)),t!==r&&v.trigger("change")}function _(){D(),b=0,x="down",v.trigger("touchspin.on.startspin"),v.trigger("touchspin.on.startdownspin"),d=setTimeout(function(){c=setInterval(function(){b++,y()},a.stepinterval)},a.stepintervaldelay)}function C(){D(),b=0,x="up",v.trigger("touchspin.on.startspin"),v.trigger("touchspin.on.startupspin"),f=setTimeout(function(){l=setInterval(function(){b++,w()},a.stepinterval)},a.stepintervaldelay)}function D(){switch(clearTimeout(d),clearTimeout(f),clearInterval(c),clearInterval(l),x){case"up":v.trigger("touchspin.on.stopupspin"),v.trigger("touchspin.on.stopspin");break;case"down":v.trigger("touchspin.on.stopdownspin"),v.trigger("touchspin.on.stopspin")}b=0,x=!1}!function(){if(v.data("alreadyinitialized"))return;if(v.data("alreadyinitialized",!0),o+=1,v.data("spinnerid",o),!v.is("input"))return void console.log("Must be an input.");a=t.extend({},e,h,(r={},t.each(i,function(t,o){var n="bts-"+o;v.is("[data-"+n+"]")&&(r[t]=v.data(n))}),r),s),""!==a.initval&&""===v.val()&&v.val(a.initval),m(),function(){var o=v.val(),n=v.parent();""!==o&&(o=Number(o).toFixed(a.decimals));v.data("initvalue",o).val(o),v.addClass("form-control"),n.hasClass("input-group")?function(o){o.addClass("bootstrap-touchspin");var n,s,e=v.prev(),i=v.next(),u='<div class="input-group-prepend bootstrap-touchspin-prefix"><span class="input-group-text">'+a.prefix+"</span></div>",r='<div class="input-group-append bootstrap-touchspin-postfix"><span class="input-group-text">'+a.postfix+"</span></div>";e.hasClass("input-group-btn")?(n='<button class="'+a.buttondown_class+' bootstrap-touchspin-down" type="button">'+a.buttondown_txt+"</button>",e.append(n)):(n='<div class="input-group-prepend"><button class="'+a.buttondown_class+' bootstrap-touchspin-down" type="button">'+a.buttondown_txt+"</button></div>",t(n).insertBefore(v));i.hasClass("input-group-btn")?(s='<button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+"</button>",i.prepend(s)):(s='<div class="input-group-append"><button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+"</button></div>",t(s).insertAfter(v));t(u).insertBefore(v),t(r).insertAfter(v),p=o}(n):function(){var o;o=a.verticalbuttons?'<div class="input-group bootstrap-touchspin"><div class="input-group-prepend bootstrap-touchspin-prefix">'+a.prefix+'</div><div class="input-group-append bootstrap-touchspin-postfix">'+a.postfix+'</div><span class="input-group-btn-vertical"><button class="'+a.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+a.verticalupclass+'"></i></button><button class="'+a.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+a.verticaldownclass+'"></i></button></span></div>':'<div class="input-group bootstrap-touchspin"><div class="input-group-prepend"><button class="'+a.buttondown_class+' bootstrap-touchspin-down" type="button">'+a.buttondown_txt+'</button></div><div class="input-group-prepend bootstrap-touchspin-prefix"><span class="input-group-text">'+a.prefix+'</span></div><div class="input-group-append bootstrap-touchspin-postfix"><span class="input-group-text">'+a.postfix+'</span></div><div class="input-group-append"><button class="'+a.buttonup_class+' bootstrap-touchspin-up" type="button">'+a.buttonup_txt+"</button></div></div>";p=t(o).insertBefore(v),t(".bootstrap-touchspin-prefix",p).after(v),v.hasClass("input-sm")?p.addClass("input-group-sm"):v.hasClass("input-lg")&&p.addClass("input-group-lg")}()}(),u={down:t(".bootstrap-touchspin-down",p),up:t(".bootstrap-touchspin-up",p),input:t("input",p),prefix:t(".bootstrap-touchspin-prefix",p).addClass(a.prefix_extraclass),postfix:t(".bootstrap-touchspin-postfix",p).addClass(a.postfix_extraclass)},function(){""===a.prefix&&u.prefix.hide();""===a.postfix&&u.postfix.hide()}(),v.on("keydown",function(t){var o=t.keyCode||t.which;38===o?("up"!==x&&(w(),C()),t.preventDefault()):40===o&&("down"!==x&&(y(),_()),t.preventDefault())}),v.on("keyup",function(t){var o=t.keyCode||t.which;38===o?D():40===o&&D()}),v.on("blur",function(){m()}),u.down.on("keydown",function(t){var o=t.keyCode||t.which;32!==o&&13!==o||("down"!==x&&(y(),_()),t.preventDefault())}),u.down.on("keyup",function(t){var o=t.keyCode||t.which;32!==o&&13!==o||D()}),u.up.on("keydown",function(t){var o=t.keyCode||t.which;32!==o&&13!==o||("up"!==x&&(w(),C()),t.preventDefault())}),u.up.on("keyup",function(t){var o=t.keyCode||t.which;32!==o&&13!==o||D()}),u.down.on("mousedown.touchspin",function(t){u.down.off("touchstart.touchspin"),v.is(":disabled")||(y(),_(),t.preventDefault(),t.stopPropagation())}),u.down.on("touchstart.touchspin",function(t){u.down.off("mousedown.touchspin"),v.is(":disabled")||(y(),_(),t.preventDefault(),t.stopPropagation())}),u.up.on("mousedown.touchspin",function(t){u.up.off("touchstart.touchspin"),v.is(":disabled")||(w(),C(),t.preventDefault(),t.stopPropagation())}),u.up.on("touchstart.touchspin",function(t){u.up.off("mousedown.touchspin"),v.is(":disabled")||(w(),C(),t.preventDefault(),t.stopPropagation())}),u.up.on("mouseout touchleave touchend touchcancel",function(t){x&&(t.stopPropagation(),D())}),u.down.on("mouseout touchleave touchend touchcancel",function(t){x&&(t.stopPropagation(),D())}),u.down.on("mousemove touchmove",function(t){x&&(t.stopPropagation(),t.preventDefault())}),u.up.on("mousemove touchmove",function(t){x&&(t.stopPropagation(),t.preventDefault())}),t(document).on(n(["mouseup","touchend","touchcancel"],o).join(" "),function(t){x&&(t.preventDefault(),D())}),t(document).on(n(["mousemove","touchmove","scroll","scrollstart"],o).join(" "),function(t){x&&(t.preventDefault(),D())}),v.on("mousewheel DOMMouseScroll",function(t){if(a.mousewheel&&v.is(":focus")){var o=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),o<0?y():w()}}),v.on("touchspin.uponce",function(){D(),w()}),v.on("touchspin.downonce",function(){D(),y()}),v.on("touchspin.startupspin",function(){C()}),v.on("touchspin.startdownspin",function(){_()}),v.on("touchspin.stopspin",function(){D()}),v.on("touchspin.updatesettings",function(o,n){!function(o){var n;n=o,a=t.extend({},a,n),n.postfix&&v.parent().find(".bootstrap-touchspin-postfix").text(n.postfix),n.prefix&&v.parent().find(".bootstrap-touchspin-prefix").text(n.prefix),m();var s=u.input.val();""!==s&&(s=Number(u.input.val()),u.input.val(s.toFixed(a.decimals)))}(n)}),u.input.css("display","block");var r}()})}this.each(function(){var o=t(this).data();t(document).off(n(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],o.spinnerid).join(" "))})}}(jQuery);